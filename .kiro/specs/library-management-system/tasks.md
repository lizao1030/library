# 实现计划: 图书馆管理系统

## 概述

本计划将图书馆管理系统的设计分解为可执行的编码任务，按照后端 → 前端 → 集成的顺序进行开发。

## 任务列表

- [x] 1. 项目初始化与基础配置
  - [x] 1.1 创建后端项目结构
    - 创建 Flask 项目目录结构
    - 配置 requirements.txt 依赖文件
    - 创建配置文件 config.py
    - _需求: 所有需求的基础_

  - [x] 1.2 创建前端项目结构
    - 使用 Vite 创建 Vue 3 项目
    - 安装 Element Plus、Vue Router、Axios
    - 配置项目基础结构
    - _需求: 所有需求的基础_

  - [x] 1.3 配置数据库连接
    - 配置 SQLAlchemy 连接 MySQL
    - 创建数据库初始化脚本
    - _需求: 所有需求的基础_

- [x] 2. 用户模块开发
  - [x] 2.1 实现用户数据模型
    - 创建 User 模型类
    - 实现密码加密方法（bcrypt）
    - _需求: 1.4_

  - [x] 2.2 编写密码加密属性测试
    - **属性 2: 密码加密存储**
    - **验证需求: 1.4**

  - [x] 2.3 实现用户注册 API
    - 创建 /api/auth/register 接口
    - 实现用户名和邮箱唯一性校验
    - 实现输入验证
    - _需求: 1.1, 1.2, 1.3_

  - [x] 2.4 编写用户名唯一性属性测试
    - **属性 7: 用户名唯一性**
    - **验证需求: 1.2**

  - [x] 2.5 实现用户登录 API
    - 创建 /api/auth/login 接口
    - 实现 JWT token 生成
    - 实现角色区分逻辑
    - _需求: 2.1, 2.2, 2.3, 2.4_

  - [x] 2.6 实现用户管理 API
    - 创建 /api/users 接口（列表、更新）
    - 实现用户禁用/启用功能
    - 实现角色更改功能
    - _需求: 9.1, 9.2, 9.3_

- [x] 3. 检查点 - 用户模块测试
  - 确保所有用户模块测试通过
  - 如有问题请询问用户

- [x] 4. 图书模块开发
  - [x] 4.1 实现图书数据模型
    - 创建 Book 模型类
    - 实现 ISBN 验证方法
    - _需求: 3.4_

  - [x] 4.2 实现图书入库 API
    - 创建 /api/books POST 接口
    - 实现 ISBN 重复检测和数量更新
    - 实现输入验证
    - _需求: 3.1, 3.2, 3.3_

  - [x] 4.3 实现图书查询 API
    - 创建 /api/books GET 接口
    - 实现多字段组合搜索
    - 实现分页功能
    - _需求: 4.1, 4.2, 4.3, 4.4_

  - [x] 4.4 编写搜索结果相关性属性测试
    - **属性 6: 搜索结果相关性**
    - **验证需求: 4.1, 4.2**

  - [x] 4.5 实现图书详情和更新 API
    - 创建 /api/books/{id} GET/PUT/DELETE 接口
    - _需求: 3.1_

- [x] 5. 检查点 - 图书模块测试
  - 确保所有图书模块测试通过
  - 如有问题请询问用户

- [-] 6. 借阅模块开发
  - [x] 6.1 实现借阅数据模型
    - 创建 Borrow 模型类
    - 实现借阅状态枚举
    - _需求: 5.5, 6.4_

  - [x] 6.2 实现借书 API
    - 创建 /api/borrows POST 接口
    - 实现库存检查逻辑
    - 实现逾期用户检查
    - 实现借阅期限设置（30天）
    - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

  - [x] 6.3 编写库存非负约束属性测试
    - **属性 3: 库存非负约束**
    - **验证需求: 5.2**

  - [x] 6.4 编写借阅期限设置属性测试
    - **属性 5: 借阅期限设置**
    - **验证需求: 5.4, 5.5**

  - [x] 6.5 编写逾期用户借阅限制属性测试
    - **属性 8: 逾期用户借阅限制**
    - **验证需求: 5.3**

  - [x] 6.6 实现还书 API
    - 创建 /api/borrows/{id}/return PUT 接口
    - 实现库存恢复逻辑
    - 实现逾期状态判断
    - 实现逾期天数计算
    - _需求: 6.1, 6.2, 6.3, 6.4_

  - [x] 6.7 编写借阅归还往返一致性属性测试
    - **属性 1: 借阅归还往返一致性**
    - **验证需求: 5.1, 6.1**

  - [x] 6.8 编写逾期天数计算属性测试
    - **属性 4: 逾期天数计算正确性**
    - **验证需求: 6.3**

  - [x] 6.9 实现借阅历史查询 API
    - 创建 /api/borrows GET 接口
    - 实现按用户筛选
    - 实现状态筛选
    - _需求: 7.1, 7.3_

- [x] 7. 检查点 - 借阅模块测试
  - 确保所有借阅模块测试通过
  - 如有问题请询问用户

- [x] 8. 统计模块开发
  - [x] 8.1 实现借阅统计 API
    - 创建 /api/statistics/borrows 接口
    - 实现按月/季度统计
    - 实现借阅排行榜
    - _需求: 8.1_

  - [x] 8.2 实现用户统计 API
    - 创建 /api/statistics/users 接口
    - 实现活跃用户排行
    - _需求: 8.2_

  - [x] 8.3 实现数据导出功能
    - 实现 CSV/Excel 导出
    - _需求: 8.3_

- [-] 9. 前端开发
  - [x] 9.1 实现登录注册页面
    - 创建登录表单组件
    - 创建注册表单组件
    - 实现表单验证
    - 实现 token 存储
    - _需求: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3_

  - [x] 9.2 实现图书管理页面
    - 创建图书列表组件
    - 创建图书搜索组件
    - 创建图书入库表单
    - 实现分页功能
    - _需求: 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4_

  - [x] 9.3 实现借阅管理页面
    - 创建借阅列表组件
    - 创建借书操作组件
    - 创建还书操作组件
    - 实现逾期高亮显示
    - _需求: 5.1, 5.2, 6.1, 6.2, 7.1, 7.2, 7.3_

  - [x] 9.4 实现统计报表页面
    - 创建统计图表组件
    - 创建排行榜组件
    - 实现数据导出按钮
    - _需求: 8.1, 8.2, 8.3_

  - [x] 9.5 实现用户管理页面（管理员）
    - 创建用户列表组件
    - 实现用户状态切换
    - 实现角色修改
    - _需求: 9.1, 9.2, 9.3_

- [x] 10. 检查点 - 前端功能测试
  - 确保所有前端页面功能正常
  - 如有问题请询问用户

- [x] 11. 集成与部署
  - [x] 11.1 前后端集成测试
    - 测试所有 API 接口
    - 测试前后端数据交互
    - _需求: 所有需求_

  - [x] 11.2 编写项目文档
    - 创建 README.md
    - 编写运行说明
    - 编写依赖清单
    - _需求: 作业提交要求_

  - [x] 11.3 Docker 容器化（可选）
    - 创建 Dockerfile
    - 创建 docker-compose.yml
    - _需求: 作业模板建议_

- [-] 12. 最终检查点
  - 确保所有测试通过
  - 确保文档完整
  - 如有问题请询问用户

## 备注

- 所有任务都必须完成，包括属性测试
- 每个检查点用于验证阶段性成果
- 属性测试使用 Hypothesis 库，每个测试运行至少100次迭代
