# 需求文档

## 简介

本文档定义了一个轻量级图书馆管理系统的需求规范。该系统面向高校图书馆和社区图书馆，实现图书的入库、借阅、归还、查询，以及用户管理、借阅统计等基础功能。

## 术语表

- **系统**: 图书馆管理系统
- **用户**: 系统用户，包括管理员和普通读者
- **管理员**: 管理员用户，拥有图书管理和用户管理权限
- **读者**: 普通读者用户，可以借阅和归还图书
- **图书**: 图书实体，包含ISBN、书名、作者、出版社、馆藏位置等信息
- **借阅记录**: 记录用户借阅图书的信息
- **ISBN**: 国际标准书号，图书的唯一标识

## 需求列表

### 需求 1: 用户注册

**用户故事:** 作为一名访客，我希望能够注册账户，以便访问图书馆系统。

#### 验收标准

1. 当访客提交包含用户名、密码和邮箱的注册表单时，系统应创建一个新的读者账户
2. 当访客提交的用户名已存在时，系统应拒绝注册并显示错误信息
3. 当访客提交的邮箱格式无效时，系统应拒绝注册并显示验证错误
4. 系统应使用 bcrypt 加密用户密码后再存储

### 需求 2: 用户登录

**用户故事:** 作为一名用户，我希望能够登录系统，以便访问我的账户并执行操作。

#### 验收标准

1. 当用户提交有效的凭证时，系统应验证用户身份并创建会话
2. 当用户提交无效的凭证时，系统应拒绝登录并显示错误信息
3. 当用户成功登录时，系统应将管理员用户重定向到管理员仪表板，将读者用户重定向到读者仪表板
4. 系统应为已认证的操作维护用户会话

### 需求 3: 图书入库

**用户故事:** 作为一名管理员，我希望能够添加新图书到图书馆，以便读者可以借阅。

#### 验收标准

1. 当管理员提交图书信息（ISBN、书名、作者、出版社、馆藏位置、数量）时，系统应创建新的图书记录
2. 当管理员提交的图书ISBN已存在时，系统应更新现有图书的数量
3. 当管理员提交不完整的图书信息时，系统应拒绝提交并显示验证错误
4. 系统应在接受图书录入前验证ISBN格式

### 需求 4: 图书查询

**用户故事:** 作为一名用户，我希望能够搜索图书，以便找到我想借阅的书籍。

#### 验收标准

1. 当用户按书名、作者或ISBN搜索时，系统应返回匹配的图书并支持分页
2. 当用户使用多个条件搜索时，系统应返回满足所有条件的图书
3. 当没有图书匹配搜索条件时，系统应显示"未找到结果"的提示
4. 系统应在搜索结果中显示图书的可借状态
5. 系统应在1.5秒内加载搜索结果

### 需求 5: 借书功能

**用户故事:** 作为一名读者，我希望能够借阅图书，以便阅读它们。

#### 验收标准

1. 当读者请求借阅一本可用的图书时，系统应创建借阅记录并将图书库存减1
2. 当读者请求借阅库存为0的图书时，系统应拒绝请求并显示"库存不足"
3. 当读者有逾期未还的图书时，系统应阻止新的借阅直到逾期图书归还
4. 系统应为每次借阅设置默认30天的借阅期限
5. 系统应在借阅记录中记录借阅日期和预计归还日期

### 需求 6: 还书功能

**用户故事:** 作为一名读者，我希望能够归还借阅的图书，以便完成借阅周期。

#### 验收标准

1. 当读者归还图书时，系统应将借阅记录状态更新为"已归还"并将图书库存加1
2. 当读者在到期日之后归还图书时，系统应将记录标记为"逾期归还"
3. 系统应计算并显示逾期归还的逾期天数
4. 系统应在借阅记录中记录实际归还日期

### 需求 7: 借阅状态查询

**用户故事:** 作为一名读者，我希望能够查看我的借阅历史，以便追踪我借阅的图书。

#### 验收标准

1. 当读者查看借阅历史时，系统应显示所有借阅记录及其状态
2. 系统应在借阅列表中高亮显示逾期图书
3. 系统应显示当前借阅的剩余天数

### 需求 8: 借阅统计报表

**用户故事:** 作为一名管理员，我希望能够查看借阅统计，以便了解图书馆的使用情况。

#### 验收标准

1. 当管理员请求借阅统计时，系统应按月/季度显示借阅量最高的图书
2. 当管理员请求用户统计时，系统应显示最活跃的读者
3. 系统应提供统计数据的导出功能

### 需求 9: 用户管理

**用户故事:** 作为一名管理员，我希望能够管理用户账户，以便维护系统安全。

#### 验收标准

1. 当管理员查看用户列表时，系统应显示所有注册用户及其角色
2. 当管理员禁用用户账户时，系统应阻止该用户登录
3. 当管理员更改用户角色时，系统应立即更新该用户的权限
